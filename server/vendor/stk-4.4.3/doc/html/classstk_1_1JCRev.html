<HTML>
<HEAD>
<TITLE>The Synthesis ToolKit in C++ (STK)</TITLE>
<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<CENTER>
<img src="princeton.gif"> &nbsp; <img src="ccrma.gif"> &nbsp; <img src="mcgill.gif"><P>
<a class="qindex" href="index.html">Home</a> &nbsp; <a class="qindex" href="information.html">Information</a> &nbsp; <a class="qindex" href="classes.html">Classes</a> &nbsp; <a class="qindex" href="download.html">Download</a> &nbsp; <a class="qindex" href="usage.html">Usage</a> &nbsp; <a class="qindex" href="maillist.html">Mail List</a> &nbsp; <a class="qindex" href="system.html">Requirements</a> &nbsp; <a class="qindex" href="links.html">Links</a> &nbsp; <a class="qindex" href="faq.html">FAQ</a> &nbsp; <a class="qindex" href="tutorial.html">Tutorial</a></CENTER>
<HR>
<!-- Generated by Doxygen 1.6.2 -->
  <div class="navpath"><a class="el" href="namespacestk.html">stk</a>::<a class="el" href="classstk_1_1JCRev.html">JCRev</a>
  </div>
<div class="contents">
<h1>stk::JCRev Class Reference</h1><!-- doxytag: class="stk::JCRev" --><!-- doxytag: inherits="stk::Effect" -->
<p>John Chowning's reverberator class.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="JCRev_8h_source.html">JCRev.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for stk::JCRev:</div>
<div class="dynsection">
 <div class="center">
  <img src="classstk_1_1JCRev.png" usemap="#stk::JCRev_map" alt=""/>
  <map id="stk::JCRev_map" name="stk::JCRev_map">
<area href="classstk_1_1Effect.html" alt="stk::Effect" shape="rect" coords="0,56,71,80"/>
<area href="classstk_1_1Stk.html" alt="stk::Stk" shape="rect" coords="0,0,71,24"/>
</map>
 </div>
</div>

<p><a href="classstk_1_1JCRev-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5b9f0e2b7acc1fcb94a663353f1253dd"></a><!-- doxytag: member="stk::JCRev::JCRev" ref="a5b9f0e2b7acc1fcb94a663353f1253dd" args="(StkFloat T60=1.0)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstk_1_1JCRev.html#a5b9f0e2b7acc1fcb94a663353f1253dd">JCRev</a> (StkFloat T60=1.0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Class constructor taking a T60 decay time argument (one second default value). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abf92e9783e4a738b6d3a3350bfae986e"></a><!-- doxytag: member="stk::JCRev::clear" ref="abf92e9783e4a738b6d3a3350bfae986e" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstk_1_1JCRev.html#abf92e9783e4a738b6d3a3350bfae986e">clear</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset and clear all internal state. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8f4caa6de1e662c76b853ebab814a2eb"></a><!-- doxytag: member="stk::JCRev::setT60" ref="a8f4caa6de1e662c76b853ebab814a2eb" args="(StkFloat T60)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstk_1_1JCRev.html#a8f4caa6de1e662c76b853ebab814a2eb">setT60</a> (StkFloat T60)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the reverberation T60 decay time. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">StkFloat&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstk_1_1JCRev.html#a599e46bcfbc2b4b9a30a30d67580412b">lastOut</a> (unsigned int channel=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the specified channel value of the last computed stereo frame.  <a href="#a599e46bcfbc2b4b9a30a30d67580412b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">StkFloat&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstk_1_1JCRev.html#ad667b48a6dbd663f2d7c49e201325f00">tick</a> (StkFloat input, unsigned int channel=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Input one sample to the effect and return the specified <code>channel</code> value of the computed stereo frame.  <a href="#ad667b48a6dbd663f2d7c49e201325f00"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstk_1_1JCRev.html#abfdf0b4db6d08cce1b0473776fce03d5">tick</a> (<a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;frames, unsigned int channel=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Take a channel of the <a class="el" href="classstk_1_1StkFrames.html" title="An STK class to handle vectorized audio data.">StkFrames</a> object as inputs to the effect and replace with stereo outputs.  <a href="#abfdf0b4db6d08cce1b0473776fce03d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstk_1_1JCRev.html#ad6ae1c038bd3e5f8b40f18bed1dc026a">tick</a> (<a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;iFrames, <a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;oFrames, unsigned int iChannel=0, unsigned int oChannel=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Take a channel of the <code>iFrames</code> object as inputs to the effect and write stereo outputs to the <code>oFrames</code> object.  <a href="#ad6ae1c038bd3e5f8b40f18bed1dc026a"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>John Chowning's reverberator class. </p>
<p>This class takes a monophonic input signal and produces a stereo output signal. It is derived from the CLM <a class="el" href="classstk_1_1JCRev.html" title="John Chowning&#39;s reverberator class.">JCRev</a> function, which is based on the use of networks of simple allpass and comb delay filters. This class implements three series allpass units, followed by four parallel comb filters, and two decorrelation delay lines in parallel at the output.</p>
<p>Although not in the original JC reverberator, one-pole lowpass filters have been added inside the feedback comb filters.</p>
<p>by Perry R. Cook and Gary P. Scavone, 1995-2011. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a599e46bcfbc2b4b9a30a30d67580412b"></a><!-- doxytag: member="stk::JCRev::lastOut" ref="a599e46bcfbc2b4b9a30a30d67580412b" args="(unsigned int channel=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StkFloat stk::JCRev::lastOut </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>channel</em> = <code>0</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the specified channel value of the last computed stereo frame. </p>
<p>Use the <a class="el" href="classstk_1_1Effect.html#a3d7e2b8942bf7adcc71dfc6dccbb7aa0" title="Return an StkFrames reference to the last output sample frame.">lastFrame()</a> function to get both values of the last computed stereo frame. The <code>channel</code> argument must be 0 or 1 (the first channel is specified by 0). However, range checking is only performed if _STK_DEBUG_ is defined during compilation, in which case an out-of-range value will trigger an <a class="el" href="classstk_1_1StkError.html" title="STK error handling class.">StkError</a> exception. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00101"></a>00101 {
<a name="l00102"></a>00102 <span class="preprocessor">#if defined(_STK_DEBUG_)</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span>  <span class="keywordflow">if</span> ( channel &gt; 1 ) {
<a name="l00104"></a>00104     oStream_ &lt;&lt; <span class="stringliteral">&quot;JCRev::lastOut(): channel argument must be less than 2!&quot;</span>;
<a name="l00105"></a>00105     <a class="code" href="classstk_1_1Stk.html#a48ac73a0d8ca28445ba1a054e1f061ff" title="Static function for error reporting and handling using c-strings.">handleError</a>( StkError::FUNCTION_ARGUMENT );
<a name="l00106"></a>00106   }
<a name="l00107"></a>00107 <span class="preprocessor">#endif</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00109"></a>00109   <span class="keywordflow">return</span> lastFrame_[channel];
<a name="l00110"></a>00110 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad667b48a6dbd663f2d7c49e201325f00"></a><!-- doxytag: member="stk::JCRev::tick" ref="ad667b48a6dbd663f2d7c49e201325f00" args="(StkFloat input, unsigned int channel=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StkFloat stk::JCRev::tick </td>
          <td>(</td>
          <td class="paramtype">StkFloat&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>channel</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Input one sample to the effect and return the specified <code>channel</code> value of the computed stereo frame. </p>
<p>Use the <a class="el" href="classstk_1_1Effect.html#a3d7e2b8942bf7adcc71dfc6dccbb7aa0" title="Return an StkFrames reference to the last output sample frame.">lastFrame()</a> function to get both values of the computed stereo output frame. The <code>channel</code> argument must be 0 or 1 (the first channel is specified by 0). However, range checking is only performed if _STK_DEBUG_ is defined during compilation, in which case an out-of-range value will trigger an <a class="el" href="classstk_1_1StkError.html" title="STK error handling class.">StkError</a> exception. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00113"></a>00113 {
<a name="l00114"></a>00114 <span class="preprocessor">#if defined(_STK_DEBUG_)</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span>  <span class="keywordflow">if</span> ( channel &gt; 1 ) {
<a name="l00116"></a>00116     oStream_ &lt;&lt; <span class="stringliteral">&quot;JCRev::tick(): channel argument must be less than 2!&quot;</span>;
<a name="l00117"></a>00117     <a class="code" href="classstk_1_1Stk.html#a48ac73a0d8ca28445ba1a054e1f061ff" title="Static function for error reporting and handling using c-strings.">handleError</a>( StkError::FUNCTION_ARGUMENT );
<a name="l00118"></a>00118   }
<a name="l00119"></a>00119 <span class="preprocessor">#endif</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>
<a name="l00121"></a>00121   StkFloat temp, temp0, temp1, temp2, temp3, temp4, temp5, temp6;
<a name="l00122"></a>00122   StkFloat filtout;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   temp = allpassDelays_[0].lastOut();
<a name="l00125"></a>00125   temp0 = allpassCoefficient_ * temp;
<a name="l00126"></a>00126   temp0 += input;
<a name="l00127"></a>00127   allpassDelays_[0].tick(temp0);
<a name="l00128"></a>00128   temp0 = -(allpassCoefficient_ * temp0) + temp;
<a name="l00129"></a>00129     
<a name="l00130"></a>00130   temp = allpassDelays_[1].lastOut();
<a name="l00131"></a>00131   temp1 = allpassCoefficient_ * temp;
<a name="l00132"></a>00132   temp1 += temp0;
<a name="l00133"></a>00133   allpassDelays_[1].tick(temp1);
<a name="l00134"></a>00134   temp1 = -(allpassCoefficient_ * temp1) + temp;
<a name="l00135"></a>00135     
<a name="l00136"></a>00136   temp = allpassDelays_[2].lastOut();
<a name="l00137"></a>00137   temp2 = allpassCoefficient_ * temp;
<a name="l00138"></a>00138   temp2 += temp1;
<a name="l00139"></a>00139   allpassDelays_[2].tick(temp2);
<a name="l00140"></a>00140   temp2 = -(allpassCoefficient_ * temp2) + temp;
<a name="l00141"></a>00141     
<a name="l00142"></a>00142   temp3 = temp2 + ( combFilters_[0].tick( combCoefficient_[0] * combDelays_[0].<a class="code" href="classstk_1_1JCRev.html#a599e46bcfbc2b4b9a30a30d67580412b" title="Return the specified channel value of the last computed stereo frame.">lastOut</a>() ) );
<a name="l00143"></a>00143   temp4 = temp2 + ( combFilters_[1].tick( combCoefficient_[1] * combDelays_[1].<a class="code" href="classstk_1_1JCRev.html#a599e46bcfbc2b4b9a30a30d67580412b" title="Return the specified channel value of the last computed stereo frame.">lastOut</a>() ) );
<a name="l00144"></a>00144   temp5 = temp2 + ( combFilters_[2].tick( combCoefficient_[2] * combDelays_[2].<a class="code" href="classstk_1_1JCRev.html#a599e46bcfbc2b4b9a30a30d67580412b" title="Return the specified channel value of the last computed stereo frame.">lastOut</a>() ) );
<a name="l00145"></a>00145   temp6 = temp2 + ( combFilters_[3].tick( combCoefficient_[3] * combDelays_[3].<a class="code" href="classstk_1_1JCRev.html#a599e46bcfbc2b4b9a30a30d67580412b" title="Return the specified channel value of the last computed stereo frame.">lastOut</a>() ) );
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   combDelays_[0].tick(temp3);
<a name="l00148"></a>00148   combDelays_[1].tick(temp4);
<a name="l00149"></a>00149   combDelays_[2].tick(temp5);
<a name="l00150"></a>00150   combDelays_[3].tick(temp6);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   filtout = temp3 + temp4 + temp5 + temp6;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154   lastFrame_[0] = effectMix_ * (outLeftDelay_.tick(filtout));
<a name="l00155"></a>00155   lastFrame_[1] = effectMix_ * (outRightDelay_.tick(filtout));
<a name="l00156"></a>00156   temp = (1.0 - effectMix_) * input;
<a name="l00157"></a>00157   lastFrame_[0] += temp;
<a name="l00158"></a>00158   lastFrame_[1] += temp;
<a name="l00159"></a>00159     
<a name="l00160"></a>00160   <span class="keywordflow">return</span> 0.7 * lastFrame_[channel];
<a name="l00161"></a>00161 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abfdf0b4db6d08cce1b0473776fce03d5"></a><!-- doxytag: member="stk::JCRev::tick" ref="abfdf0b4db6d08cce1b0473776fce03d5" args="(StkFrames &amp;frames, unsigned int channel=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstk_1_1StkFrames.html">StkFrames</a>&amp; stk::JCRev::tick </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>frames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>channel</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Take a channel of the <a class="el" href="classstk_1_1StkFrames.html" title="An STK class to handle vectorized audio data.">StkFrames</a> object as inputs to the effect and replace with stereo outputs. </p>
<p>The <a class="el" href="classstk_1_1StkFrames.html" title="An STK class to handle vectorized audio data.">StkFrames</a> argument reference is returned. The stereo outputs are written to the <a class="el" href="classstk_1_1StkFrames.html" title="An STK class to handle vectorized audio data.">StkFrames</a> argument starting at the specified <code>channel</code>. Therefore, the <code>channel</code> argument must be less than ( channels() - 1 ) of the <a class="el" href="classstk_1_1StkFrames.html" title="An STK class to handle vectorized audio data.">StkFrames</a> argument (the first channel is specified by 0). However, range checking is only performed if _STK_DEBUG_ is defined during compilation, in which case an out-of-range value will trigger an <a class="el" href="classstk_1_1StkError.html" title="STK error handling class.">StkError</a> exception. </p>

</div>
</div>
<a class="anchor" id="ad6ae1c038bd3e5f8b40f18bed1dc026a"></a><!-- doxytag: member="stk::JCRev::tick" ref="ad6ae1c038bd3e5f8b40f18bed1dc026a" args="(StkFrames &amp;iFrames, StkFrames &amp;oFrames, unsigned int iChannel=0, unsigned int oChannel=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstk_1_1StkFrames.html">StkFrames</a>&amp; stk::JCRev::tick </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>iFrames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classstk_1_1StkFrames.html">StkFrames</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>oFrames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>iChannel</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>oChannel</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Take a channel of the <code>iFrames</code> object as inputs to the effect and write stereo outputs to the <code>oFrames</code> object. </p>
<p>The <code>iFrames</code> object reference is returned. The <code>iChannel</code> argument must be less than the number of channels in the <code>iFrames</code> argument (the first channel is specified by 0). The <code>oChannel</code> argument must be less than ( channels() - 1 ) of the <code>oFrames</code> argument. However, range checking is only performed if _STK_DEBUG_ is defined during compilation, in which case an out-of-range value will trigger an <a class="el" href="classstk_1_1StkError.html" title="STK error handling class.">StkError</a> exception. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="JCRev_8h_source.html">JCRev.h</a></li>
</ul>
</div>
<HR>

<table>
  <tr><td><A HREF="http://ccrma.stanford.edu/software/stk/"><I>The Synthesis ToolKit in C++ (STK)</I></A></td></tr>
  <tr><td>&copy;1995-2011 Perry R. Cook and Gary P. Scavone. All Rights Reserved.</td></tr>
</table>

</BODY>
</HTML>
